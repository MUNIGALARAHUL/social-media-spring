{"ast":null,"code":"import { HTTP_INTERCEPTORS } from '@angular/common/http';\nimport { HttpErrorResponse } from '@angular/common/http';\nimport { tap } from 'rxjs/operators';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../_services/token-storage.service\";\nimport * as i2 from \"@angular/router\";\nconst TOKEN_HEADER_KEY = 'Authorization';\nexport class AuthInterceptor {\n  constructor(token, router) {\n    this.token = token;\n    this.router = router;\n  }\n  intercept(req, next) {\n    let authReq = req;\n    const loginPath = '/login';\n    const token = this.token.getToken();\n    if (token != null) {\n      authReq = req.clone({\n        headers: req.headers.set(TOKEN_HEADER_KEY, 'Bearer ' + token)\n      });\n    }\n    return next.handle(authReq).pipe(tap(() => {}, err => {\n      if (err instanceof HttpErrorResponse) {\n        if (err.status !== 401 || window.location.pathname === loginPath) {\n          return;\n        }\n        this.token.signOut();\n        window.location.href = loginPath;\n      }\n    }));\n  }\n}\nAuthInterceptor.ɵfac = function AuthInterceptor_Factory(t) {\n  return new (t || AuthInterceptor)(i0.ɵɵinject(i1.TokenStorageService), i0.ɵɵinject(i2.Router));\n};\nAuthInterceptor.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n  token: AuthInterceptor,\n  factory: AuthInterceptor.ɵfac\n});\nexport const authInterceptorProviders = [{\n  provide: HTTP_INTERCEPTORS,\n  useClass: AuthInterceptor,\n  multi: true\n}];","map":{"version":3,"names":["HTTP_INTERCEPTORS","HttpErrorResponse","tap","TOKEN_HEADER_KEY","AuthInterceptor","constructor","token","router","intercept","req","next","authReq","loginPath","getToken","clone","headers","set","handle","pipe","err","status","window","location","pathname","signOut","href","i0","ɵɵinject","i1","TokenStorageService","i2","Router","factory","ɵfac","authInterceptorProviders","provide","useClass","multi"],"sources":["F:\\TEST1\\angular-social-login\\src\\app\\_helpers\\auth.interceptor.ts"],"sourcesContent":["import { HTTP_INTERCEPTORS, HttpEvent } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { HttpInterceptor, HttpHandler, HttpRequest, HttpErrorResponse } from '@angular/common/http';\nimport { Router } from '@angular/router';\nimport { TokenStorageService } from '../_services/token-storage.service';\nimport {tap} from 'rxjs/operators';\nimport { Observable } from 'rxjs';\n\nconst TOKEN_HEADER_KEY = 'Authorization';\n\n@Injectable()\nexport class AuthInterceptor implements HttpInterceptor {\n\tconstructor(private token: TokenStorageService, private router: Router) {\n\n\t}\n\n\tintercept(req: HttpRequest<any>, next: HttpHandler): Observable<HttpEvent<any>> {\n\t\tlet authReq = req;\n\t\tconst loginPath = '/login';\n\t\tconst token = this.token.getToken();\n\t\tif (token != null) {\n\t\t\tauthReq = req.clone({ headers: req.headers.set(TOKEN_HEADER_KEY, 'Bearer ' + token) });\n\t\t}\n\t\treturn next.handle(authReq).pipe( tap(() => {},\n\t\t(err: any) => {\n\t\t\tif (err instanceof HttpErrorResponse) {\n\t\t\t\tif (err.status !== 401 || window.location.pathname === loginPath) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis.token.signOut();\n\t\t\t\twindow.location.href = loginPath;\n\t\t\t}\n\t\t}\n\t\t));\n\t}\n}\n\nexport const authInterceptorProviders = [\n{ provide: HTTP_INTERCEPTORS, useClass: AuthInterceptor, multi: true }\n];\n"],"mappings":"AAAA,SAASA,iBAAiB,QAAmB,sBAAsB;AAEnE,SAAoDC,iBAAiB,QAAQ,sBAAsB;AAGnG,SAAQC,GAAG,QAAO,gBAAgB;;;;AAGlC,MAAMC,gBAAgB,GAAG,eAAe;AAGxC,OAAM,MAAOC,eAAe;EAC3BC,YAAoBC,KAA0B,EAAUC,MAAc;IAAlD,KAAAD,KAAK,GAALA,KAAK;IAA+B,KAAAC,MAAM,GAANA,MAAM;EAE9D;EAEAC,SAASA,CAACC,GAAqB,EAAEC,IAAiB;IACjD,IAAIC,OAAO,GAAGF,GAAG;IACjB,MAAMG,SAAS,GAAG,QAAQ;IAC1B,MAAMN,KAAK,GAAG,IAAI,CAACA,KAAK,CAACO,QAAQ,EAAE;IACnC,IAAIP,KAAK,IAAI,IAAI,EAAE;MAClBK,OAAO,GAAGF,GAAG,CAACK,KAAK,CAAC;QAAEC,OAAO,EAAEN,GAAG,CAACM,OAAO,CAACC,GAAG,CAACb,gBAAgB,EAAE,SAAS,GAAGG,KAAK;MAAC,CAAE,CAAC;;IAEvF,OAAOI,IAAI,CAACO,MAAM,CAACN,OAAO,CAAC,CAACO,IAAI,CAAEhB,GAAG,CAAC,MAAK,CAAE,CAAC,EAC7CiB,GAAQ,IAAI;MACZ,IAAIA,GAAG,YAAYlB,iBAAiB,EAAE;QACrC,IAAIkB,GAAG,CAACC,MAAM,KAAK,GAAG,IAAIC,MAAM,CAACC,QAAQ,CAACC,QAAQ,KAAKX,SAAS,EAAE;UACjE;;QAED,IAAI,CAACN,KAAK,CAACkB,OAAO,EAAE;QACpBH,MAAM,CAACC,QAAQ,CAACG,IAAI,GAAGb,SAAS;;IAElC,CAAC,CACA,CAAC;EACH;;AAvBYR,eAAe,C;mBAAfA,eAAe,EAAAsB,EAAA,CAAAC,QAAA,CAAAC,EAAA,CAAAC,mBAAA,GAAAH,EAAA,CAAAC,QAAA,CAAAG,EAAA,CAAAC,MAAA;AAAA;AAAf3B,eAAe,C;SAAfA,eAAe;EAAA4B,OAAA,EAAf5B,eAAe,CAAA6B;AAAA;AA0B5B,OAAO,MAAMC,wBAAwB,GAAG,CACxC;EAAEC,OAAO,EAAEnC,iBAAiB;EAAEoC,QAAQ,EAAEhC,eAAe;EAAEiC,KAAK,EAAE;AAAI,CAAE,CACrE"},"metadata":{},"sourceType":"module","externalDependencies":[]}